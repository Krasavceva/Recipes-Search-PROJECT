{"mappings":"imBAsBA,IAAAA,EACAC,E,iFArBA,IAAIC,EAAU,GAoBdF,EAlBA,SAAkBG,GAGhB,IAFA,IAAIC,EAAOC,OAAOD,KAAKD,GAEdG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC/BJ,EAAQE,EAAKE,IAAMH,EAAMC,EAAKE,G,EAelCL,EAXA,SAAiBO,GACf,IAAIC,EAAWP,EAAQM,GAEvB,GAAgB,MAAZC,EACF,MAAM,IAAIC,MAAM,oCAAsCF,GAGxD,OAAOC,C,KCnBTE,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,wJCAxC,IAAAC,IAAoB,MAAQJ,EAAA,SAAAK,QAA6C,SAAQC,OAAAC,KAAAC,KAAEC,WCAnF,IAAAL,IAAoB,MAAQJ,EAAA,SAAAK,QAA6C,SAAQC,OAAAC,KAAAC,KAAEC,WCGpG,IAAIC,EAAQC,aAAaC,QAAQ,gBAC7BC,EAAQX,KAAKC,MAAMQ,aAAaC,QAAQ,eAAiB,MACzDE,EAAQZ,KAAKC,MAAMQ,aAAaC,QAAQ,cAAgB,MACxDG,EAAIF,EAAMG,QAAQN,GAElBO,EAAaC,SAASC,cAAc,MACpCC,EAASF,SAASC,cAAc,sBAEhCE,EAAeV,aAAaC,QAAQ,aAEpCU,EAAQ,GACRC,EAAU,GA6CdC,eAAeC,IACX,IACI,GAAoB,GAAhBH,EAAM1B,OACNsB,SAASC,cAAc,MAAMO,YAAc,qBAE3C,IAAK,IAAI7B,KAAMyB,EAAO,CAClB,IAAId,EAAM,wDAAwDX,IAClE,MAAM8B,QAAiBC,MAAMpB,GACvBqB,QAAaF,EAASG,OAC5BP,EAAQQ,KAAKF,EAAKG,MAAM,G,EAGlC,MAAOC,GACLC,QAAQD,MAAM,SAAUA,E,CAC3B,SAlCL,SAAmBE,GACf,IAAIC,EAAe,GACnBhB,EAAOiB,UAAY,GACnB,IAAK,IAAIxC,EAAK,EAAGA,EAAKsC,EAAQvC,OAAQC,IAClCuC,GAAgB,wGAEiCD,EAAQtC,GAAIyC,qBAAqBH,EAAQtC,GAAI0C,sBAAsBJ,EAAQtC,GAAI2C,oKAGpFL,EAAQtC,GAAI2C,mEACZL,EAAQtC,GAAI4C,8LAGqDN,EAAQtC,GAAIyC,gGAI7HlB,EAAOiB,UAAYD,C,CAkBfM,CAAUnB,E,EAIlBL,SAASyB,iBAAiB,oBAAoB,YA9D9C,WACQjC,GAAkB,IAATA,GACTO,EAAWS,YAAc,YAAYZ,EAAMC,KAC3CE,EAAW2B,UAAUC,IAAI,eACrBxB,EACAA,EAAenB,KAAKC,MAAMkB,IAE1BA,EAAe,CAAC,CACZyB,MAAOpC,EACPqC,WAAY,KAEhB7B,SAASC,cAAc,MAAMO,YAAc,kBAG/CR,SAASC,cAAc,MAAMO,YAAc,kCAG/C,IAAIsB,EAAQ3B,EAAa4B,WAAWC,GAAOA,EAAGJ,QAAUpC,IACpDsC,GAAQ,IACR1B,EAAQD,EAAa2B,GAAOD,WAAWI,Q,CA4C3CC,GACA3B,G","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-7aa4a9614706c71f.js","node_modules/@parcel/runtime-js/lib/runtime-e558359ac24a2789.js","node_modules/@parcel/runtime-js/lib/runtime-a92ae39e79ae386d.js","src/favourites_page/js/favourites.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"8KcgT\\\":\\\"favourites.01258d5d.js\\\",\\\"11Lkf\\\":\\\"heart_red.cdb1f07e.png\\\",\\\"eBKIm\\\":\\\"heart.4cc18b58.png\\\"}\"));","module.exports = new __parcel__URL__(\"../\" + require('./helpers/bundle-manifest').resolve(\"11Lkf\")).toString();","module.exports = new __parcel__URL__(\"../\" + require('./helpers/bundle-manifest').resolve(\"eBKIm\")).toString();","import imgMarkerFilled from \"../../recipe_page/img/heart_red.png\";\nimport imgMarkerNonFilled from \"../../recipe_page/img/heart.png\";\n\nlet email = localStorage.getItem(\"welcomeemail\");\nlet users = JSON.parse(localStorage.getItem('useremails') || '[]');\nlet names = JSON.parse(localStorage.getItem('usernames') || '[]');\nlet i = users.indexOf(email);\n\nlet welcomeMsg = document.querySelector(\"h1\");\nlet result = document.querySelector('.result__container');\n\nlet arrFavorites = localStorage.getItem('favorites');\n\nlet array = [];\nlet dataArr = [];\n\nfunction checkRegistration() {\n    if (email && email != \"\") {\n        welcomeMsg.textContent = `Welcome, ${names[i]}`;\n        welcomeMsg.classList.add('welcome-msg');\n        if (arrFavorites) { // если в сторадже что-то есть\n            arrFavorites = JSON.parse(arrFavorites);\n        } else {\n            arrFavorites = [{\n                email: email,\n                favRecipes: []\n            }]\n            document.querySelector(\"h2\").textContent = \"No favourites\";\n        }\n    } else {\n        document.querySelector(\"h2\").textContent = \"You need to register or sign in\";\n    };\n\n    let index = arrFavorites.findIndex((el) => el.email === email);\n    if (index > -1) {\n        array = arrFavorites[index].favRecipes.slice();\n    }\n}\n\nfunction renderFav(dataArr) {\n    let generatedFav = '';\n    result.innerHTML = '';\n    for (let id = 0; id < dataArr.length; id++) {\n        generatedFav += `\n                <div class=\"result__item\">\n                <a href='../recipe_page/recipe.html?id=${dataArr[id].idMeal}'><img src=\"${dataArr[id].strMealThumb}\" alt=\"${dataArr[id].strMeal}\"></a>\n                    <div class=\"item__details\">\n                        <div class=\"details\">\n                            <h2 class=\"item-name\">${dataArr[id].strMeal}</h2>\n                            <h3 class=\"item-area\">${dataArr[id].strArea}</h3>\n                        </div>\n                        \n                        <button class=\"view-button\" onclick=\"window.location.href = '../recipe_page/recipe.html?id=${dataArr[id].idMeal}'\">View recipe</button>\n                    </div>            \n                </div>`\n    }\n    result.innerHTML = generatedFav;\n}\n\nasync function getRecipes() {\n    try {\n        if (array.length == 0) {\n            document.querySelector(\"h2\").textContent = \"No favourites\";\n        } else {\n            for (let id of array) {\n                let url = `https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`;\n                const response = await fetch(url);\n                const data = await response.json();\n                dataArr.push(data.meals[0]);\n            }\n        }\n    } catch (error) {\n        console.error('Error:', error);\n    } finally {\n        renderFav(dataArr);\n    }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    checkRegistration();\n    getRecipes(dataArr);\n});\n\n/* <div class = \"recipe__marker\" >\n    <\n    button class = \"recipe__marker-btn\" > < img src = \"./img/bookmark-filled.svg\"\nalt = \"bookmark\"\nclass = \"recipe__marker-btn-img\"\ndata - id = $ {\n        dataArr[d].idMeal\n    } > < /button> <\n    /div> */\n\n\n\n\n\n// document.addEventListener('click', function (e) {\n//     if (e.target.classList.contains('recipe__marker-btn-img')) {\n//         e.target.classList.toggle('active');\n//     }\n//     addFav(e);\n// });\n\n// function addFav(e) {\n//     console.log(e.target.dataset.id);\n//     if (e.target.classList.contains('active')) {\n//         arrFavorites.push(e.target.dataset.id);\n//         e.target.src = \"img/bookmark-filled.svg\";\n//     } else {\n//         e.target.src = \"img/bookmark.svg\";\n//         arrFavorites = arrFavorites.filter(el => el !== e.target.dataset.id);\n//     }\n//     localStorage.setItem('favorites', JSON.stringify(arrFavorites));\n//     // checkFav(e);\n// }\n/* function checkFav(e) {\n    if (arrFavorites) { // если в сторадже что-то есть, то парсим\n        arrFavorites = JSON.parse(arrFavorites);\n        if (arrFavorites.find(el => el == e.target.dataset.id)) {\n            console.log(arrFavorites.find(el => el == e.target.dataset.id));\n            this.className += ' active';\n            this.src = \"img/bookmark-filled.svg\";\n        }\n    } else {\n        // если нет, то присвоим дефолтное значение\n        arrFavorites = [];\n    }\n\n}*/"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","URL","resolve","import","meta","url","toString","$89d80e6d5d2b17d9$var$email","localStorage","getItem","$89d80e6d5d2b17d9$var$users","$89d80e6d5d2b17d9$var$names","$89d80e6d5d2b17d9$var$i","indexOf","$89d80e6d5d2b17d9$var$welcomeMsg","document","querySelector","$89d80e6d5d2b17d9$var$result","$89d80e6d5d2b17d9$var$arrFavorites","$89d80e6d5d2b17d9$var$array","$89d80e6d5d2b17d9$var$dataArr","async","$89d80e6d5d2b17d9$var$getRecipes","textContent","response","fetch","data","json","push","meals","error","console","dataArr","generatedFav","innerHTML","idMeal","strMealThumb","strMeal","strArea","$89d80e6d5d2b17d9$var$renderFav","addEventListener","classList","add","email","favRecipes","index","findIndex","el","slice","$89d80e6d5d2b17d9$var$checkRegistration"],"version":3,"file":"favourites.01258d5d.js.map"}